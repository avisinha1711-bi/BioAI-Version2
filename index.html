<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BioAI – AI-powered Cancer Photoacoustic Diagnosis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c2e44 0%, #1a4d6e 100%);
            color: #f5f5f5;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            flex: 1;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        .logo {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .logo-icon {
            font-size: 3.5rem;
            color: #4ecdc4;
            margin-bottom: 10px;
        }
        
        .logo-text {
            font-size: 2.2rem;
            font-weight: 700;
            color: #fff;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #d1e8e2;
            margin-top: 10px;
        }
        
        .author {
            font-size: 1rem;
            color: #a3c4c2;
            margin-top: 5px;
        }
        
        .section {
            margin: 40px 0;
            padding: 30px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
        }
        
        .section-title {
            font-size: 1.8rem;
            color: #4ecdc4;
            margin-bottom: 25px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(78, 205, 196, 0.3);
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 12px;
            font-size: 1.1rem;
            color: #d1e8e2;
        }
        
        .input-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 1.1rem;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.3);
        }
        
        .feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.95rem;
            display: none;
        }
        
        .feedback.normal {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            display: block;
        }
        
        .feedback.high {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            display: block;
        }
        
        .feedback.low {
            background: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
            display: block;
        }
        
        .feedback.error {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            display: block;
        }
        
        .btn {
            display: block;
            width: 100%;
            padding: 18px;
            background: linear-gradient(45deg, #4ecdc4, #2a9d8f);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            margin-top: 20px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .result {
            margin-top: 30px;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            display: none;
        }
        
        .result.high-risk {
            background: rgba(231, 76, 60, 0.2);
            border: 2px solid #e74c3c;
            display: block;
        }
        
        .result.low-risk {
            background: rgba(46, 204, 113, 0.2);
            border: 2px solid #2ecc71;
            display: block;
        }
        
        .probability-meter {
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
        }
        
        .probability-fill {
            height: 100%;
            border-radius: 15px;
            transition: width 0.5s ease-in-out;
        }
        
        .probability-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #d1e8e2;
        }
        
        .risk-level {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 15px 0;
        }
        
        .recommendation {
            margin-top: 15px;
            font-size: 1.1rem;
            line-height: 1.5;
        }
        
        .patient-info {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            text-align: left;
        }
        
        .patient-info p {
            margin: 10px 0;
            font-size: 1.1rem;
        }
        
        .patient-counter {
            text-align: center;
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #4ecdc4;
        }
        
        .next-patient {
            display: none;
            margin-top: 20px;
            text-align: center;
        }
        
        /* Hide the API status element */
        .api-status {
            display: none !important;
        }
        
        .disclaimer {
            margin-top: 30px;
            padding: 15px;
            background: rgba(241, 196, 15, 0.15);
            border: 1px solid rgba(241, 196, 15, 0.3);
            border-radius: 8px;
            font-size: 0.85rem;
            color: #f1c40f;
            text-align: center;
        }
        
        .footer-text {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            color: #a3c4c2;
            font-size: 1rem;
            font-weight: 500;
        }
        
        @media (max-width: 768px) {
            .container {
                width: 95%;
                padding: 20px;
            }
            
            .logo-text {
                font-size: 1.8rem;
            }
            
            .section {
                padding: 20px;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .disclaimer {
                font-size: 0.8rem;
                padding: 12px;
            }
            
            .footer-text {
                font-size: 0.9rem;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-dna"></i>
                </div>
                <div class="logo-text">BioAI</div>
            </div>
            <div class="subtitle">AI-powered Cancer Photoacoustic Diagnosis</div>
            <div class="author">Developed by: Avi Sinha</div>
        </header>

        <!-- API status element is present but hidden with CSS -->
        <div class="api-status" id="api-status" style="display: none;">
            <i class="fas fa-sync fa-spin"></i> Checking backend connection...
        </div>

        <div class="patient-counter" id="patient-counter">
            Patient 1: Provide IR frequency readings (MHz)
        </div>

        <div class="section">
            <h2 class="section-title">Patient Information</h2>
            
            <div class="input-group">
                <label for="patient-name">Patient Name</label>
                <input type="text" id="patient-name" placeholder="Enter patient name...">
                <div class="feedback" id="name-feedback"></div>
            </div>
            
            <div class="input-group">
                <label for="patient-age">Patient Age</label>
                <input type="number" id="patient-age" min="1" max="120" placeholder="Enter patient age...">
                <div class="feedback" id="age-feedback"></div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">Infrared Frequency Readings</h2>
            
            <div class="input-group">
                <label for="input1">ENTER THE READING OF (-C=O) VIBRATION OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY (~1720 cm⁻¹)</label>
                <input type="number" step="0.01" id="input1" class="frequency-input" placeholder="Enter value...">
                <div class="feedback" id="feedback1"></div>
            </div>
            
            <div class="input-group">
                <label for="input2">ENTER THE READING OF (-CH3) VIBRATION OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY (~1300 cm⁻¹)</label>
                <input type="number" step="0.01" id="input2" class="frequency-input" placeholder="Enter value...">
                <div class="feedback" id="feedback2"></div>
            </div>
            
            <div class="input-group">
                <label for="input3">ENTER THE READING OF (-C-OH) VIBRATION OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY (~1100 cm⁻¹)</label>
                <input type="number" step="0.01" id="input3" class="frequency-input" placeholder="Enter value...">
                <div class="feedback" id="feedback3"></div>
            </div>
            
            <div class="input-group">
                <label for="input4">ENTER THE READING OF (-O-H) VIBRATION OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY (~3500 cm⁻¹)</label>
                <input type="number" step="0.01" id="input4" class="frequency-input" placeholder="Enter value...">
                <div class="feedback" id="feedback4"></div>
            </div>
            
            <button class="btn" id="analyze-btn">Analyze Patient Data</button>
            
            <div class="next-patient" id="next-patient">
                <button class="btn" id="next-btn">Next Patient</button>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">Diagnosis Results</h2>
            
            <div class="result" id="result">
                <h3>Patient Diagnosis</h3>
                
                <div class="probability-meter">
                    <div class="probability-fill" id="probability-fill"></div>
                </div>
                
                <div class="probability-labels">
                    <span>0%</span>
                    <span>50%</span>
                    <span>100%</span>
                </div>
                
                <div class="risk-level" id="risk-level"></div>
                <div id="probability-text">Probability: <span id="probability-value">0</span>%</div>
                <div class="recommendation" id="recommendation"></div>
                
                <div class="patient-info" id="patient-info">
                    <!-- Patient information will be displayed here -->
                </div>
            </div>
        </div>
        
        <!-- Disclaimer Section -->
        <div class="disclaimer">
            <i class="fas fa-exclamation-triangle"></i> 
            <strong>Important Notice:</strong> This page demonstrates a conceptual workflow for AI-assisted interpretation of infrared/photoacoustic spectral features. Real diagnostic systems analyze the entire spectrum, perform rigorous preprocessing and validation, and are evaluated in clinical studies. This demo is for education only and the real spectroscopy dataset model will soon be made.
        </div>
    </div>
    
    <!-- Added footer text below the container -->
    <div class="footer-text">
        BioAI Cancer Diagnosis | AI Based Cancer Diagnosis Test Model<br>
        © 2025 BioAI Research, Avi Sinha
    </div>

    <script>
        // Configuration
        const REGION_NAMES = [
            "ENTER THE READING OF (-C=O) VIBRATION OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY (~1720 cm⁻¹)",
            "ENTER THE READING OF (-CH3) VIBRATION OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY (~1300 cm⁻¹)",
            "ENTER THE READING OF (-C-OH) VIBRATION OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY (~1100 cm⁻¹)",
            "ENTER THE READING OF (-O-H) VIBRATION OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY (~3500 cm⁻¹)"
        ];

        const NORMAL_MEANS = [1.2, 1.8, 2.8, 2.2];
        const NORMAL_STDS = [0.4, 0.6, 0.7, 0.9];
        const THRESHOLD = 0.42; // Best threshold from your model

        // State
        let patientCount = 1;
        let backendAvailable = false;

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Check backend connection (but don't show status)
            checkBackendConnection();
            
            // Set up event listeners for frequency inputs
            document.querySelectorAll('.frequency-input').forEach((input, index) => {
                input.addEventListener('input', () => validateInput(index));
            });
            
            // Set up event listeners for patient info
            document.getElementById('patient-name').addEventListener('input', validatePatientInfo);
            document.getElementById('patient-age').addEventListener('input', validatePatientInfo);
            
            document.getElementById('analyze-btn').addEventListener('click', analyzePatient);
            document.getElementById('next-btn').addEventListener('click', nextPatient);
        });

        // Check if backend is available (but don't display status)
        async function checkBackendConnection() {
            try {
                // In a real implementation, this would be your actual backend URL
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/1', {
                    method: 'GET'
                });
                
                if (response.ok) {
                    backendAvailable = true;
                } else {
                    backendAvailable = false;
                }
            } catch (error) {
                backendAvailable = false;
            }
        }

        // Validate patient information
        function validatePatientInfo() {
            const nameInput = document.getElementById('patient-name');
            const ageInput = document.getElementById('patient-age');
            const nameFeedback = document.getElementById('name-feedback');
            const ageFeedback = document.getElementById('age-feedback');
            
            // Validate name
            if (nameInput.value.trim() === '') {
                nameFeedback.className = 'feedback error';
                nameFeedback.innerHTML = '⚠️ Please enter patient name';
                nameInput.style.borderColor = '#e74c3c';
            } else {
                nameFeedback.className = 'feedback';
                nameInput.style.borderColor = '';
            }
            
            // Validate age
            if (!ageInput.value) {
                ageFeedback.className = 'feedback error';
                ageFeedback.innerHTML = '⚠️ Please enter patient age';
                ageInput.style.borderColor = '#e74c3c';
            } else if (parseInt(ageInput.value) < 1 || parseInt(ageInput.value) > 120) {
                ageFeedback.className = 'feedback error';
                ageFeedback.innerHTML = '⚠️ Please enter a valid age (1-120)';
                ageInput.style.borderColor = '#e74c3c';
            } else {
                ageFeedback.className = 'feedback';
                ageInput.style.borderColor = '';
            }
        }

        // Validate input and provide feedback
        function validateInput(index) {
            const input = document.getElementById(`input${index+1}`);
            const feedback = document.getElementById(`feedback${index+1}`);
            
            if (!input.value) {
                feedback.className = 'feedback';
                return;
            }
            
            const value = parseFloat(input.value);
            
            // Check for negative values
            if (value < 0) {
                feedback.className = 'feedback error';
                feedback.innerHTML = '❌ Negative values are not allowed';
                input.style.borderColor = '#e74c3c';
                return;
            }
            
            const mean = NORMAL_MEANS[index];
            const std = NORMAL_STDS[index];
            
            if (Math.abs(value - mean) <= std) {
                feedback.className = 'feedback normal';
                feedback.innerHTML = '✅ At normal level';
                input.style.borderColor = '';
            } else if (value > mean) {
                feedback.className = 'feedback high';
                feedback.innerHTML = '⚠️ Higher than normal level';
                input.style.borderColor = '';
            } else {
                feedback.className = 'feedback low';
                feedback.innerHTML = '⚠️ Lower than normal level';
                input.style.borderColor = '';
            }
        }

        // Analyze patient data
        async function analyzePatient() {
            // Validate patient info
            const nameInput = document.getElementById('patient-name');
            const ageInput = document.getElementById('patient-age');
            
            if (nameInput.value.trim() === '' || !ageInput.value || 
                parseInt(ageInput.value) < 1 || parseInt(ageInput.value) > 120) {
                validatePatientInfo();
                alert('Please fill in valid patient information');
                return;
            }
            
            // Get input values
            const values = [];
            let allFilled = true;
            let hasNegative = false;
            
            for (let i = 1; i <= 4; i++) {
                const input = document.getElementById(`input${i}`);
                if (!input.value) {
                    allFilled = false;
                    input.style.borderColor = '#e74c3c';
                } else if (parseFloat(input.value) < 0) {
                    hasNegative = true;
                    input.style.borderColor = '#e74c3c';
                } else {
                    input.style.borderColor = '';
                    values.push(parseFloat(input.value));
                }
            }
            
            if (!allFilled) {
                alert('Please fill in all fields');
                return;
            }
            
            if (hasNegative) {
                alert('Negative values are not allowed. Please enter positive values only.');
                return;
            }
            
            // Show loading state
            document.getElementById('analyze-btn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analyzing...';
            document.getElementById('analyze-btn').disabled = true;
            
            let probability;
            
            if (backendAvailable) {
                // Call real backend API
                try {
                    // In a real implementation, this would be your actual backend endpoint
                    const response = await fetch('https://your-backend-url.com/api/predict', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ values: values })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        probability = data.probability;
                    } else {
                        throw new Error('Backend prediction failed');
                    }
                } catch (error) {
                    console.error('Backend call failed:', error);
                    // Fall back to demo mode
                    probability = simulatePrediction(values);
                }
            } else {
                // Use demo mode
                probability = simulatePrediction(values);
            }
            
            // Display results
            displayResults(probability, nameInput.value, ageInput.value);
            
            // Reset button
            document.getElementById('analyze-btn').innerHTML = 'Analyze Patient Data';
            document.getElementById('analyze-btn').disabled = false;
            
            // Show next patient button
            document.getElementById('next-patient').style.display = 'block';
            document.getElementById('analyze-btn').style.display = 'none';
        }

        // Simulate prediction (for demo purposes)
        function simulatePrediction(values) {
            // This is a simplified simulation of your model's prediction logic
            let score = 0;
            for (let i = 0; i < values.length; i++) {
                const deviation = (values[i] - NORMAL_MEANS[i]) / NORMAL_STDS[i];
                score += Math.max(0, deviation);
            }
            
            // Convert to probability (sigmoid-like function)
            const rawProb = 1 / (1 + Math.exp(-score * 0.5 + 2));
            
            // Add some randomness to simulate real model behavior
            return Math.min(0.99, rawProb + (Math.random() * 0.1 - 0.05));
        }

        // Display results
        function displayResults(probability, name, age) {
            const resultDiv = document.getElementById('result');
            const probabilityFill = document.getElementById('probability-fill');
            const probabilityValue = document.getElementById('probability-value');
            const riskLevel = document.getElementById('risk-level');
            const recommendation = document.getElementById('recommendation');
            const patientInfo = document.getElementById('patient-info');
            
            // Update probability meter
            const percentage = Math.round(probability * 100);
            probabilityFill.style.width = `${percentage}%`;
            probabilityValue.textContent = percentage;
            
            // Set colors and text based on risk
            if (probability >= THRESHOLD) {
                resultDiv.className = 'result high-risk';
                probabilityFill.style.background = 'linear-gradient(90deg, #e74c3c, #c0392b)';
                riskLevel.innerHTML = '⚠️ HIGH RISK OF CANCER DETECTION';
                riskLevel.style.color = '#e74c3c';
                recommendation.innerHTML = `<strong>${name}</strong> has a high probability of cancer detection and may require further diagnosis through biopsy sample analysis, CT scans, MRI, or X-rays.`;
            } else {
                resultDiv.className = 'result low-risk';
                probabilityFill.style.background = 'linear-gradient(90deg, #2ecc71, #27ae60)';
                riskLevel.innerHTML = '✅ LOW RISK OF CANCER DETECTION';
                riskLevel.style.color = '#2ecc71';
                recommendation.innerHTML = `<strong>${name}</strong> has a low probability of cancer detection but may need regular monitoring if symptoms persist.`;
            }
            
            // Display patient information
            patientInfo.innerHTML = `
                <p><strong>Patient Name:</strong> ${name}</p>
                <p><strong>Patient Age:</strong> ${age}</p>
                <p><strong>Diagnosis Date:</strong> ${new Date().toLocaleDateString()}</p>
            `;
            
            // Show results
            resultDiv.style.display = 'block';
        }

        // Reset for next patient
        function nextPatient() {
            patientCount++;
            
            // Clear inputs
            document.getElementById('patient-name').value = '';
            document.getElementById('patient-age').value = '';
            document.getElementById('name-feedback').className = 'feedback';
            document.getElementById('age-feedback').className = 'feedback';
            
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`input${i}`).value = '';
                document.getElementById(`feedback${i}`).className = 'feedback';
            }
            
            // Hide results
            document.getElementById('result').style.display = 'none';
            
            // Update patient counter
            document.getElementById('patient-counter').textContent = `Patient ${patientCount}: Provide IR frequency readings (MHz)`;
            
            // Show analyze button, hide next button
            document.getElementById('analyze-btn').style.display = 'block';
            document.getElementById('next-patient').style.display = 'none';
        }
    </script>
</body>
</html>
